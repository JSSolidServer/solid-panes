# 20210404a
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>.
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>.
@prefix owl: <http://www.w3.org/2002/07/owl#>.
@prefix solid: <http://www.w3.org/ns/solid/terms#>.
@prefix ui: <http://www.w3.org/ns/ui#>.
@prefix schema: <http://schema.org/>.
@prefix vcard: <http://www.w3.org/2006/vcard/ns#>.

@prefix org: <http://www.w3.org/ns/org#>.
@prefix : <#>.

:this
    <http://purl.org/dc/elements/1.1/title> "Profile form" ;
    a ui:Form ;
    # ui:part :backgroundColor, :highlightColor;
    ui:parts (
      :styleGroup
      :pronounsForm
      :involvementWithOrganizationsForm
      ).

:styleGroup a ui:Group; ui:parts ( :styleHeading :backgroundColor :highlightColor ).
    :styleHeading a ui:Heading; ui:contents "The style of your public profile.".
    :backgroundColor a ui:ColorField; ui:property solid:profileBackgroundColor;
      ui:label "Background color"; ui:default "#ffffff".
    :highlightColor a ui:ColorField; ui:property solid:profileHighlightColor;
      ui:label "Highlight color"; ui:default "#000000".

 # Pronouns

 :pronounsForm a ui:Group; ui:parts ( :pronounsPrompt :subjectPronounForm :objectPronounForm :relativePronounForm) .

    :pronounsPrompt a ui:Comment; ui:contents  "What are your pronouns?" .

    :subjectPronounForm a ui:SingleLineTextField; ui:property solid:preferredSubjectPronoun;
        ui:size 10; ui:label "he/she/they..." .
    :objectPronounForm a ui:SingleLineTextField; ui:property solid:preferredObjectPronoun;
        ui:size 10; ui:label "him/her/them..." .
    :relativePronounForm a ui:SingleLineTextField; ui:property solid:preferredRelativePronoun;
        ui:size 10; ui:label "his/hers/theirs..." .

  # Curriculum Vitae: membership of organizations

  solid:Role a rdfs:Class; owl:oneOf ( solid:CurrentRole solid:FormerRole). # Future Role too?

  org:member owl:inverse [ ui:label "involvement with company, org etc" ]. # timelimited involvement

  :involvementWithOrganizationsForm a ui:Multiple;
      ui:label "Involvement with Organization";
      ui:property org:member; ui:reverse true; # link back from role to member
      ui:ordered false; # Allow user to order CV secions rather than force date order? No.
      ui:part :membershipForm.

  :membershipForm a ui:Group; ui:parts ( :roleNameField :escoOccupationField :instituteIdentityField :orgField :startField :endField ).

      :startField a ui:DateField; ui:property schema:startDate; ui:label "Starting"@en, "DÃ©but"@fr.
      :endField   a ui:DateField; ui:property schema:endDate;   ui:label "Ending"@en, "Fin"@fr.
      :orgField a ui:Choice; ui:label "Organization"@en, "Organization"@fr;
          ui:canMintNew true; ui:use :OrganizationCreationForm ;
          ui:property org:organization;
          ui:from vcard:Organization .
     :roleNameField a ui:SingleLineTextField; ui:property vcard:role; ui:size 60 .

    :escoOccupationField a ui:AutocompleteField; ui:label "occupation";
         ui:property org:; ui:dataSource :ESCO_Occupation_DataSource .

         :ESCO_Occupation_DataSource a ui:DataSource;
            schema:name "ESCO";
            schema:logo "https://ec.europa.eu/esco/portal/static_resource2/images/logo/logo_en.gif";
            ui:searchByNameURI "https://ec.europa.eu/esco/api/search?language=$(language)&type=occupation&text=$(name)".


     :instituteIdentityField a ui:AutocompleteField; ui:label "in wikidata";
          ui:property solid:publicId; ui:dataSource :WikidataOnOrganizations.

     :WikidataOnOrganizations a ui:DataSource ;
       schema:name "Wikidata";
       ui:endpoint "https://query.wikidata.org/sparql" ;
       ui:searchByNameQuery """SELECT ?subject ?name
       WHERE {
         ?klass wdt:P279* $(targetClass) .
         ?subject wdt:P31 ?klass .
         ?subject rdfs:label ?name.
         FILTER regex(?name, "$(name)", "i")
       } LIMIT $(limit) """ .


#############################################################################
# @@@@@ Kludge:  a copy of organizationForm here for simpliciity

 vcard:Organization ui:creationForm :OrganizationCreationForm  .

# Ontology data to drive the classifier

solid:InterestingOrganization owl:disjointUnionOf  (
# Airline - a Corporation
# Consortium - a Corporation or a NGO
 schema:Corporation
 schema:EducationalOrganization
# FundingScheme - eh?
 schema:GovernmentOrganization
# LibrarySystem
# LocalBusiness - Corporation
# MedicalOrganization - a Corporation or a NGO
 schema:NGO
 # NewsMediaOrganization - a Corporation or a NGO
schema:PerformingGroup # a band
schema:Project # like Solid
schema:SportsOrganization # a Team
 ) .

  :OrganizationCreationForm a ui:Form; schema:name "Form for editing a role" ;
    ui:parts ( :OrgClassifier :homePageURIField  ) .


 :OrgClassifier a ui:Classifier; ui:label "What sort of organization?"@en;
    ui:category solid:InterestingOrganization .


  :instituteNameField
      a ui:SingleLineTextField ;
      ui:label "Intitute Name";
      ui:maxLength "200" ;
      ui:property schema:name ;
      ui:size "80" .

   :homePageURIField a ui:NamedNodeURIField;
      ui:property  schema:url . # @@ ??

    :initituteTypeField a ui:Classifier;
    ui:label "What sort of organization";
    ui:category solid:InterestingOrganization .
